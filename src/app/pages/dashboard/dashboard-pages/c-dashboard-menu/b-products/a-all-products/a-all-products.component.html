<!-- @if (products.length > 0) {
<div class="card">
  <div class="flex justify-between items-center mb-3">
    <h2 class="text-2xl font-semibold">Products Control</h2>

    <p-button routerLink="/dashboard/menu/products/products-add" label="Add Products" icon="pi pi-plus"
      class="btn-main text-white"></p-button>
  </div>

  <div class="mb-3 flex justify-content-end">
    <span class="p-input-icon-right">
      <i class="pi pi-search"></i>
      <input #search class="mb-0" type="text" pInputText placeholder="Search products..."
        (input)="onGlobalFilter(dt, $event)" />
    </span>
  </div>

  <p-table #dt [paginator]="true" [rows]="rowsPerPage" [totalRecords]="totalRecords"
    [rowsPerPageOptions]="getPagination()" [showCurrentPageReport]="true" [value]="filteredProducts"
    responsiveLayout="scroll">
    <ng-template pTemplate="header">
      <tr>
        <th class="text-center" pSortableColumn="id">ID <p-sortIcon field="id"></p-sortIcon></th>
        <th class="text-center">Image</th>
        <th class="text-center" pSortableColumn="en_name">
          Name <p-sortIcon field="en_name"></p-sortIcon>
        </th>
        <th class="text-center">
          <p-dropdown #DdCategory class="mx-auto" styleClass="mx-auto" [options]="categoryData" optionLabel="label"
            optionValue="value" (onChange)="onFilterCategoryChange($event.value); DdCategory.showClear = true"
            placeholder="Category (EN)" [showClear]="true" [autoZIndex]="true"></p-dropdown>
        </th>
        <th class="text-center">
          <p-dropdown #Dd class="mx-auto" styleClass="mx-auto" [options]="selectOptions" optionLabel="label"
            optionValue="value" (onChange)="onFilterChange($event.value); Dd.showClear = true" placeholder="Status"
            [showClear]="true" [autoZIndex]="true"></p-dropdown>
        </th>
        <th class="text-center">Actions</th>
        <th class="text-center">Prices</th>
        <th class="text-center">Choices</th>
        <th class="text-center">View</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-product>
      <tr>
        <td class="text-center">{{ product.id }}</td>
        <td class="text-center">
          <img width="50" height="50" style="width: 50px; height: 50px" class="rounded-full mx-auto"
            [src]="'https://digitalbondmena.com/mesoshop/' + product.main_image" [alt]="product.en_name"
            role="presentation" />
        </td>
        <td class="text-center">{{ product.en_name }}</td>
        <td class="text-center">{{ product.category.en_name }}</td>
        <td class="text-center">
          <p-inputSwitch [ngModel]="product.active_status" (onChange)="toggleProductStatus(product)"></p-inputSwitch>
        </td>
        <td class="text-center">
          <p-button icon="pi pi-pencil" [routerLink]="['/dashboard/menu/products/products-edit', product.id]"
            class="p-button-text"></p-button>
        </td>
        <td class="text-center">

          {{ product.choices.length>0 ?"N/A":product.price
          }} </td>
        <td class="text-center">
          <ng-container *ngIf="product.choices.length > 0; else showPrice">
            <p-button icon="pi pi-list" [routerLink]="['/dashboard/menu/products/products-choice', product.id]"
              class="p-button-text"></p-button>
          </ng-container>
          <ng-template #showPrice>
        
          N/A
          </ng-template>
        </td>

        <td class="text-center">
          <button [routerLink]="['/dashboard/menu/products/view-product', product.id]" pButton label="View"
            icon="pi pi-search"></button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="9">
          <div>
            <div class="h-48 flex justify-center items-center flex-col">
              <app-no-data-found-banner></app-no-data-found-banner>
            </div>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
} @else {
<app-loading-data-banner></app-loading-data-banner>
}

<p-toast></p-toast> -->

@if (products.length > 0) {
  <div class="card">
    <div class="flex justify-between items-center mb-3">
      <h2 class="text-2xl font-semibold">Products Control</h2>
  
      <p-button routerLink="/dashboard/menu/products/products-add" label="Add Products" icon="pi pi-plus"
        class="btn-main text-white"></p-button>
    </div>
  
    <!-- Search Input -->
    <div class="mb-3 flex justify-content-end">
      <span class="p-input-icon-right">
        <i class="pi pi-search"></i>
        <input #search class="mb-0" type="text" pInputText placeholder="Search products..."
          (input)="onGlobalFilter(dt, $event)" />
      </span>
    </div>
  
    <p-table #dt [paginator]="true" [rows]="rowsPerPage" [totalRecords]="totalRecords"
      [rowsPerPageOptions]="getPagination()" [showCurrentPageReport]="true" [value]="filteredProducts"
      responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th class="text-center" pSortableColumn="id">ID <p-sortIcon field="id"></p-sortIcon></th>
          <th class="text-center">Image</th>
          <th class="text-center" pSortableColumn="en_name">
            Name <p-sortIcon field="en_name"></p-sortIcon>
          </th>
          <th class="text-center">
            <p-dropdown #DdCategory class="mx-auto" styleClass="mx-auto" [options]="categoryData" optionLabel="label"
              optionValue="value" (onChange)="onFilterCategoryChange($event.value); DdCategory.showClear = true"
              placeholder="Category " [showClear]="true" [autoZIndex]="true"></p-dropdown>
          </th>
          <th class="text-center">
            <p-dropdown #Dd class="mx-auto" styleClass="mx-auto" [options]="selectOptions" optionLabel="label"
              optionValue="value" (onChange)="onFilterChange($event.value); Dd.showClear = true" placeholder="Status"
              [showClear]="true" [autoZIndex]="true"></p-dropdown>
          </th>
          <th class="text-center">
            <p-dropdown #DdCommercial class="mx-auto" styleClass="mx-auto" [options]="commercialStatusData" optionLabel="label"
              optionValue="value" (onChange)="onFilterCommercialChange($event.value); DdCommercial.showClear = true" placeholder="Commercial Status"
              [showClear]="true" [autoZIndex]="true"></p-dropdown>
          </th>
          <th class="text-center">Actions</th>
          <th class="text-center">Prices</th>
          <th class="text-center">Choices</th>
          <th class="text-center">View</th>
        </tr>
      </ng-template>
  
      <ng-template pTemplate="body" let-product>
        <tr>
          <td class="text-center">{{ product.id }}</td>
          <td class="text-center">
            <img width="50" height="50" style="width: 50px; height: 50px" class="rounded-full mx-auto"
              [src]="'https://digitalbondmena.com/mesoshop/' + product.main_image" [alt]="product.en_name"
              role="presentation" />
          </td>
          <td class="text-center">{{ product.en_name }}</td>
          <td class="text-center">{{ product.category.en_name }}</td>
          <td class="text-center">
            <p-inputSwitch [ngModel]="product.active_status" (onChange)="toggleProductStatus(product)"></p-inputSwitch>
          </td>
          <td class="text-center">
            <span [ngClass]="product.commercial_status ? 'text-green-600 font-bold ' : 'text-blue-600 font-bold '">{{ product.commercial_status ? 'Business' : 'User' }}</span>
          </td>
          <td class="text-center">
            <p-button icon="pi pi-pencil" [routerLink]="['/dashboard/menu/products/products-edit', product.id]"
              class="p-button-text"></p-button>
          </td>
          <td class="text-center">
            {{ product.choices.length > 0 ? "N/A" : product.price }}
          </td>
          <td class="text-center">
            <ng-container *ngIf="product.choices.length > 0; else showPrice">
              <p-button icon="pi pi-list" [routerLink]="['/dashboard/menu/products/products-choice', product.id]"
                class="p-button-text"></p-button>
            </ng-container>
            <ng-template #showPrice>
              N/A
            </ng-template>
          </td>
          <td class="text-center">
            <button [routerLink]="['/dashboard/menu/products/view-product', product.id]" pButton label="View"
              icon="pi pi-search"></button>
          </td>
        </tr>
      </ng-template>
  
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="10">
            <div>
              <div class="h-48 flex justify-center items-center flex-col">
                <app-no-data-found-banner></app-no-data-found-banner>
              </div>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
  } @else {
  <app-loading-data-banner></app-loading-data-banner>
  }
  
  <p-toast></p-toast>